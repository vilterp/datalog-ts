.table mother
----
text/plain

.table father
----
text/plain

mother{child: "Pete", mother: "Mary"}.
----
text/plain
mother: [mother{child: "Pete", mother: "Mary"}; {}]

father{child: "Pete", father: "Paul"}.
----
text/plain
father: [father{child: "Pete", father: "Paul"}; {}]

mother{child: "Carolyn", mother: "Mary"}.
----
text/plain
mother: [mother{child: "Carolyn", mother: "Mary"}; {}]

father{child: "Carolyn", father: "Paul"}.
----
text/plain
father: [father{child: "Carolyn", father: "Paul"}; {}]

.rulegraph
----
application/graphviz
digraph G {
  "mother" [fillcolor="darksalmon" label="mother:  []" shape="box" style="filled"]; // cache: [mother{child: "Pete", mother: "Mary"}; {}, mother{child: "Carolyn", mother: "Mary"}; {}]
  "father" [fillcolor="darksalmon" label="father:  []" shape="box" style="filled"]; // cache: [father{child: "Pete", father: "Paul"}; {}, father{child: "Carolyn", father: "Paul"}; {}]
}

parents{child: C, mother: M, father: F} :-
  mother{child: C, mother: M} &
  father{child: C, father: F}.
----
text/plain

.rulegraph
----
application/graphviz
digraph G {
  "0" [fillcolor="thistle" label="0: parents: Join(C: father.child = mother.child) []" shape="box" style="filled"];
  "mother" [fillcolor="darksalmon" label="mother:  [child]" shape="box" style="filled"]; // cache: [mother{child: "Pete", mother: "Mary"}; {}, mother{child: "Carolyn", mother: "Mary"}; {}]
  "father" [fillcolor="darksalmon" label="father:  [child]" shape="box" style="filled"]; // cache: [father{child: "Pete", father: "Paul"}; {}, father{child: "Carolyn", father: "Paul"}; {}]
  "parents" [fillcolor="lightblue" label="parents: Subst({child: C, father: F, mother: M}) []" shape="box" style="filled"];
  "0" -> "parents" [];
  "father" -> "0" [];
  "mother" -> "0" [];
}

sibling{left: L, right: R} :-
  parents{child: L, mother: M, father: F} &
  parents{child: R, mother: M, father: F} &
  L != R.
----
text/plain

.rulegraph
----
application/graphviz
digraph G {
  "0" [fillcolor="thistle" label="0: parents: Join(C: father.child = mother.child) []" shape="box" style="filled"];
  "1" [fillcolor="thistle" label="1: sibling: Join(F: parents.father = parents.father & M: parents.mother = parents.mother) []" shape="box" style="filled"];
  "2" [fillcolor="darkseagreen1" label="2: L != R []" shape="box" style="filled"];
  "mother" [fillcolor="darksalmon" label="mother:  [child]" shape="box" style="filled"]; // cache: [mother{child: "Pete", mother: "Mary"}; {}, mother{child: "Carolyn", mother: "Mary"}; {}]
  "father" [fillcolor="darksalmon" label="father:  [child]" shape="box" style="filled"]; // cache: [father{child: "Pete", father: "Paul"}; {}, father{child: "Carolyn", father: "Paul"}; {}]
  "parents" [fillcolor="lightblue" label="parents: Subst({child: C, father: F, mother: M}) [mother-father]" shape="box" style="filled"];
  "sibling" [fillcolor="lightblue" label="sibling: Subst({left: L, right: R}) []" shape="box" style="filled"];
  "0" -> "parents" [];
  "1" -> "2" [];
  "2" -> "sibling" [];
  "father" -> "0" [];
  "mother" -> "0" [];
  "parents" -> "1" [];
  "parents" -> "1" [];
}
