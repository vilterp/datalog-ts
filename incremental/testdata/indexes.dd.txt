.table need
----
text/plain

.table worker
----
text/plain

opportunity{worker: N, capability: C, objective: O} :-
  need{capability: C, objective: O} &
  worker{name: N, capability: C}.
----
text/plain

.rulegraph
----
application/graphviz
digraph G {
  "0" [fillcolor="darkseagreen2" label="0: Match(worker{capability: C, name: N}; {}) [capability]" shape="box" style="filled"];
  "1" [fillcolor="thistle" label="1: opportunity: Join(C: 0.capability = need.capability) []" shape="box" style="filled"];
  "need" [fillcolor="darksalmon" label="need:  [capability]" shape="box" style="filled"];
  "worker" [fillcolor="darksalmon" label="worker:  []" shape="box" style="filled"];
  "opportunity" [fillcolor="lightblue" label="opportunity: Subst({capability: C, objective: O, worker: N}) []" shape="box" style="filled"];
  "0" -> "1" [];
  "1" -> "opportunity" [];
  "need" -> "1" [];
  "worker" -> "0" [];
}

need{capability: "write HTML", objective: "make website"}.
----
text/plain
need: [need{capability: "write HTML", objective: "make website"}; {}]
1: []

worker{name: "Pete", capability: "write HTML"}.
----
text/plain
worker: [worker{capability: "write HTML", name: "Pete"}; {}]
0: [worker{capability: "write HTML", name: "Pete"}; {C: "write HTML", N: "Pete"}]
1: [opportunity{capability: "write HTML", name: "Pete"}; {C: "write HTML", N: "Pete"}]
opportunity: [opportunity{capability: "write HTML", objective: O, worker: "Pete"}; {C: "write HTML", N: "Pete"}]

.dumpcaches
----
application/json
{
  "0": {
    "nodeID": "0",
    "cache": {
      "capability": {
        "items": {
          "\"write HTML\"": [
            {
              "term": {
                "type": "Record",
                "relation": "worker",
                "attrs": {
                  "name": {
                    "type": "StringLit",
                    "val": "Pete"
                  },
                  "capability": {
                    "type": "StringLit",
                    "val": "write HTML"
                  }
                }
              },
              "bindings": {
                "N": {
                  "type": "StringLit",
                  "val": "Pete"
                },
                "C": {
                  "type": "StringLit",
                  "val": "write HTML"
                }
              }
            }
          ]
        }
      }
    }
  },
  "1": {
    "nodeID": "1",
    "cache": {}
  },
  "need": {
    "nodeID": "need",
    "cache": {
      "capability": {
        "items": {
          "\"write HTML\"": [
            {
              "term": {
                "type": "Record",
                "relation": "need",
                "attrs": {
                  "capability": {
                    "type": "StringLit",
                    "val": "write HTML"
                  },
                  "objective": {
                    "type": "StringLit",
                    "val": "make website"
                  }
                }
              },
              "bindings": {}
            }
          ]
        }
      }
    }
  },
  "worker": {
    "nodeID": "worker",
    "cache": {}
  },
  "opportunity": {
    "nodeID": "opportunity",
    "cache": {}
  }
}
