.table mother
----

.table father
----

parent{child: C, parent: P} :-
  mother{child: C, mother: P} | father{child: C, father: P}.
----

grandparent{grandchild: A, grandparent: C} :-
  parent{child: A, parent: B} &
  parent{child: B, parent: C}.
----

.rulegraph
----
digraph G {
  "0" [label="0: Union"];
  "1" [label="1: Match(mother{child: C, mother: P})"];
  "2" [label="2: Match(father{child: C, father: P})"];
  "3" [label="3: Match(parent{child: B, parent: C})"];
  "4" [label="4: Match(parent{child: A, parent: B})"];
  "5" [label="5: Join(4 & 3)"];
  "father" [label="father"];
  "grandparent" [label="grandparent: Subst(grandparent{grandchild: A, grandparent: C})"];
  "mother" [label="mother"];
  "parent" [label="parent: Subst(parent{child: C, parent: P})"];
  "0" -> "parent" [];
  "1" -> "0" [];
  "2" -> "0" [];
  "3" -> "5" [];
  "4" -> "5" [];
  "5" -> "grandparent" [];
  "father" -> "2" [];
  "mother" -> "1" [];
  "parent" -> "3" [];
  "parent" -> "4" []
}

father{child: "Mary", father: "Mark"}.
----
father: [father{child: "Mary", father: "Mark"}; {}]
2: [father{child: "Mary", father: "Mark"}; {}]
0: [father{child: "Mary", father: "Mark"}; {}]
parent: [parent{child: C, parent: P}; {}]
3: [parent{child: C, parent: P}; {B: P}]
4: [parent{child: C, parent: P}; {}]
5: [parent{child: C, parent: P}; {B: P}]
5: [parent{child: C, parent: P}; {B: P}]
grandparent: [grandparent{grandchild: A, grandparent: C}; {B: P}]
grandparent: [grandparent{grandchild: A, grandparent: C}; {B: P}]
