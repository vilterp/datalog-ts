main :- "foo".
----
application/datalog
main{from: P1, to: P3} :- 
  source{char: "f", pos: P1} &
  source{char: "o", pos: P2} &
  source{char: "o", pos: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.

main :- ["foo", "bar"].
----
application/datalog
main{from: P1, to: P4} :- 
  main_seq_0{from: P1, to: P2} &
  main_seq_1{from: P3, to: P4} &
  next{left: P2, right: P3}.
main_seq_0{from: P1, to: P3} :- 
  source{char: "f", pos: P1} &
  source{char: "o", pos: P2} &
  source{char: "o", pos: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.
main_seq_1{from: P1, to: P3} :- 
  source{char: "b", pos: P1} &
  source{char: "a", pos: P2} &
  source{char: "r", pos: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.

main :- ("foo" | "bar").
----
application/datalog
main{from: P1, to: P2} :- main_choice_0{from: P1, to: P2} | main_choice_1{from: P1, to: P2}.
main_choice_0{from: P1, to: P3} :- 
  source{char: "f", pos: P1} &
  source{char: "o", pos: P2} &
  source{char: "o", pos: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.
main_choice_1{from: P1, to: P3} :- 
  source{char: "b", pos: P1} &
  source{char: "a", pos: P2} &
  source{char: "r", pos: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.
