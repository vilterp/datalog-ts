main :- "foo".
----
application/datalog
main{span: span{from: P1, to: P3}} :- 
  source{char: "f", id: P1} &
  source{char: "o", id: P2} &
  source{char: "o", id: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.

main :- ["foo", "bar"].
----
application/datalog
main{seq_0: span{from: P1, to: P2}, seq_1: span{from: P3, to: P4}, span: span{from: P1, to: P4}} :- 
  main_seq_0{span: span{from: P1, to: P2}} &
  main_seq_1{span: span{from: P3, to: P4}} &
  next{left: P2, right: P3}.
main_seq_0{span: span{from: P1, to: P3}} :- 
  source{char: "f", id: P1} &
  source{char: "o", id: P2} &
  source{char: "o", id: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.
main_seq_1{span: span{from: P1, to: P3}} :- 
  source{char: "b", id: P1} &
  source{char: "a", id: P2} &
  source{char: "r", id: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.

main :- ("foo" | "bar").
----
application/datalog
main{span: span{from: P1, to: P2}} :- 
  main_choice_0{span: span{from: P1, to: P2}} |
  main_choice_1{span: span{from: P1, to: P2}}.
main_choice_0{span: span{from: P1, to: P3}} :- 
  source{char: "f", id: P1} &
  source{char: "o", id: P2} &
  source{char: "o", id: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.
main_choice_1{span: span{from: P1, to: P3}} :- 
  source{char: "b", id: P1} &
  source{char: "a", id: P2} &
  source{char: "r", id: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.

main :- (foo | bar).
foo :- "foo".
bar :- "bar".
----
application/datalog
bar{span: span{from: P1, to: P3}} :- 
  source{char: "b", id: P1} &
  source{char: "a", id: P2} &
  source{char: "r", id: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.
foo{span: span{from: P1, to: P3}} :- 
  source{char: "f", id: P1} &
  source{char: "o", id: P2} &
  source{char: "o", id: P3} &
  next{left: P1, right: P2} &
  next{left: P2, right: P3}.
main{span: span{from: P1, to: P2}} :- 
  main_choice_0{span: span{from: P1, to: P2}} |
  main_choice_1{span: span{from: P1, to: P2}}.
main_choice_0{span: span{from: P1, to: P2}} :- foo{span: span{from: P1, to: P2}}.
main_choice_1{span: span{from: P1, to: P2}} :- bar{span: span{from: P1, to: P2}}.
