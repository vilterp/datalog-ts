main :- "foo".
--
foo
----
text/plain
> source{char: "f", id: 0}.
> source{char: "o", id: 1}.
> source{char: "o", id: 2}.
> next{left: 0, right: 1}.
> next{left: 1, right: 2}.
> next{left: 2, right: "end"}.
main{span: span{from: 0, to: "end"}}; {P1: 0, P2: 1, P3: 2, P4: "end"}.

main :- ["foo", "bar"].
--
foobar
----
text/plain
> source{char: "f", id: 0}.
> source{char: "o", id: 1}.
> source{char: "o", id: 2}.
> source{char: "b", id: 3}.
> source{char: "a", id: 4}.
> source{char: "r", id: 5}.
> next{left: 0, right: 1}.
> next{left: 1, right: 2}.
> next{left: 2, right: 3}.
main_seq_0{span: span{from: 0, to: 3}}; {P1: 0, P2: 1, P3: 2, P4: 3}.
> next{left: 3, right: 4}.
> next{left: 4, right: 5}.
> next{left: 5, right: "end"}.
main_seq_1{span: span{from: 3, to: "end"}}; {P1: 3, P2: 4, P3: 5, P4: "end"}.
main{seq_0: span{from: 0, to: 3}, seq_1: span{from: 3, to: "end"}, span: span{from: 3, to: "end"}}; {P0: 0, P1: 3, P2: "end"}.

main :- ("foo" | "bar").
--
foo
----
text/plain
> source{char: "f", id: 0}.
> source{char: "o", id: 1}.
> source{char: "o", id: 2}.
> next{left: 0, right: 1}.
> next{left: 1, right: 2}.
> next{left: 2, right: "end"}.
main_choice_0{span: span{from: 0, to: "end"}}; {P1: 0, P2: 1, P3: 2, P4: "end"}.
main{span: span{from: 0, to: "end"}}; {P1: 0, P2: "end"}.

main :- ("foo" | "bar").
--
bar
----
text/plain
> source{char: "b", id: 0}.
> source{char: "a", id: 1}.
> source{char: "r", id: 2}.
> next{left: 0, right: 1}.
> next{left: 1, right: 2}.
> next{left: 2, right: "end"}.
main_choice_1{span: span{from: 0, to: "end"}}; {P1: 0, P2: 1, P3: 2, P4: "end"}.
main{span: span{from: 0, to: "end"}}; {P1: 0, P2: "end"}.

main :- (foo | bar).
foo :- "foo".
bar :- "bar".
--
foo
----
text/plain
> source{char: "f", id: 0}.
> source{char: "o", id: 1}.
> source{char: "o", id: 2}.
> next{left: 0, right: 1}.
> next{left: 1, right: 2}.
> next{left: 2, right: "end"}.
foo{span: span{from: 0, to: "end"}}; {P1: 0, P2: 1, P3: 2, P4: "end"}.
main_choice_0{span: span{from: 0, to: "end"}}; {P1: 0, P2: "end"}.
main{span: span{from: 0, to: "end"}}; {P1: 0, P2: "end"}.

main :- repSep("a", <succeed>).
--
aaa
----
text/plain
> source{char: "a", id: 0}.
> source{char: "a", id: 1}.
> source{char: "a", id: 2}.
> next{left: 0, right: 1}.
main_item{span: span{from: 0, to: 1}}; {P1: 0, P2: 1}.
main{span: span{from: 0, to: 1}}; {P1: 0, PN: 1}.
> next{left: 1, right: 2}.
main_item{span: span{from: 1, to: 2}}; {P1: 1, P2: 2}.
main{span: span{from: 1, to: 2}}; {P1: 1, PN: 2}.
main{span: span{from: 0, to: 2}}; {P1: 0, P2: 1, PN: 2}.
> next{left: 2, right: "end"}.
main_item{span: span{from: 2, to: "end"}}; {P1: 2, P2: "end"}.
main{span: span{from: 2, to: "end"}}; {P1: 2, PN: "end"}.
main{span: span{from: 1, to: "end"}}; {P1: 1, P2: 2, PN: "end"}.
main{span: span{from: 0, to: "end"}}; {P1: 0, P2: 1, PN: "end"}.
