hl.Segment{type: T, span: S, highlight: H} :-
  hl.segmentInt{type: T, span: S, highlight: H} |
  hl.segmentString{type: T, span: S, highlight: H} |
  hl.segmentBool{type: T, span: S, highlight: H} |
  hl.keyword{type: T, span: S, highlight: H} |
  hl.segmentIdent{type: T, span: S, highlight: H} |
  hl.segmentSpecialVar{type: T, span: S, highlight: H} |
  hl.segmentIdentDefnHL{type: T, span: S, highlight: H} |
  hl.segmentIdentUsageHL{type: T, span: S, highlight: H}.

# primitives
hl.segmentInt{type: "int", span: S, highlight: false} :-
  hl.mapping{rule: R, type: "int"} &
  astInternal.node{rule: R, span: S}.
hl.segmentString{type: "string", span: S, highlight: false} :-
  hl.mapping{rule: R, type: "string"} &
  astInternal.node{rule: R, span: S}.
hl.keyword{type: "keyword", span: S, highlight: false} :-
  hl.mapping{rule: R, type: "keyword"} &
  astInternal.node{rule: R, span: S}.
hl.segmentBool{type: "bool", span: S, highlight: false} :-
  hl.mapping{rule: R, type: "bool"} &
  astInternal.node{rule: R, span: S}.

# identifiers
hl.segmentIdent{type: "var", span: S, highlight: false} :-
  hl.mapping{rule: R, type: "ident"} &
  astInternal.node{rule: R, parentID: ParamsID, span: S}.
hl.segmentSpecialVar{type: "specialVar", span: S, highlight: false} :-
  hl.mapping{rule: R, type: "specialVar"} &
  astInternal.node{rule: R, span: S}.
hl.segmentIdentDefnHL{type: "defn", span: S, highlight: true} :-
  ide.CurrentUsage{defnLoc: S} &
  scope.Defn{span: S}.
# TODO: highlight other usages
hl.segmentIdentUsageHL{type: "usage", span: S, highlight: true} :-
  ide.CurrentUsage{usageLoc: S} &
  scope.Var{span: S}.
